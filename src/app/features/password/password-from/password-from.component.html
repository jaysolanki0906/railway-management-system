<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<div class="change-password-dialog-backdrop"></div>
<div class="change-password-dialog">
  <div class="dialog-title">
    <span class="material-icons dialog-icon">lock</span>
    <span>Change Password</span>
    <button class="close-btn" aria-label="Close" (click)="onCancel()">
      <span class="material-icons">close</span>
    </button>
  </div>
  <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" autocomplete="off">
    <div class="form-group" [class.invalid]="oldPassword?.invalid && (oldPassword?.dirty || oldPassword?.touched)">
      <label>
        <span class="material-icons">vpn_key</span>
        <input type="password" placeholder="Current password" formControlName="old_password" [type]="hideOld ? 'password' : 'text'">
        <button type="button" class="eye-btn" (click)="hideOld = !hideOld" tabindex="-1">
          <span class="material-icons">{{hideOld ? 'visibility_off' : 'visibility'}}</span>
        </button>
      </label>
      </div>
      <div class="error" *ngIf="oldPassword?.hasError('required') && (oldPassword?.dirty || oldPassword?.touched)">
        Current password is required.
      </div>
    <div class="form-group" [class.invalid]="newPassword?.invalid && (newPassword?.dirty || newPassword?.touched)">
      <label>
        <span class="material-icons">lock_reset</span>
        <input type="password" placeholder="New password" formControlName="new_password" [type]="hideNew ? 'password' : 'text'">
        <button type="button" class="eye-btn" (click)="hideNew = !hideNew" tabindex="-1">
          <span class="material-icons">{{hideNew ? 'visibility_off' : 'visibility'}}</span>
        </button>
      </label>
      </div>
      <div class="error" *ngIf="newPassword?.hasError('required') && (newPassword?.dirty || newPassword?.touched)">
        New password is required.
      </div>
      <div class="error" *ngIf="newPassword?.hasError('minlength') && (newPassword?.dirty || newPassword?.touched)&&!newPassword?.hasError('required')">
        New password must be at least 8 characters.
      </div>
      <div class="error" *ngIf="newPassword?.hasError('pattern') && (newPassword?.dirty || newPassword?.touched)&&!newPassword?.hasError('minlength')">
        Must include uppercase, lowercase, number, and special character.
      </div>
    <div class="form-group" [class.invalid]="(confirmPassword?.invalid && (confirmPassword?.dirty || confirmPassword?.touched)) || (changePasswordForm.hasError('notMatching') && (confirmPassword?.dirty || confirmPassword?.touched))">
      <label>
        <span class="material-icons">check_circle</span>
        <input type="password" placeholder="Confirm new password" formControlName="confirmPassword" [type]="hideConfirm ? 'password' : 'text'">
        <button type="button" class="eye-btn" (click)="hideConfirm = !hideConfirm" tabindex="-1">
          <span class="material-icons">{{hideConfirm ? 'visibility_off' : 'visibility'}}</span>
        </button>
      </label>
      </div>
      <div class="error" *ngIf="confirmPassword?.hasError('required') && (confirmPassword?.dirty || confirmPassword?.touched)">
        Please confirm your new password.
      </div>
      <div class="error" *ngIf="changePasswordForm.hasError('notMatching') && (confirmPassword?.dirty || confirmPassword?.touched)&&!confirmPassword?.hasError('required')">
       Passwords do not match.
      </div>
    <div class="dialog-actions">
      <button type="button" class="cancel-btn" (click)="onCancel()">
        Cancel
      </button>
      <button type="submit" class="change-btn">
        Change
      </button>
    </div>
  </form>
</div>